\begin{figure}
    \footnotesize
    \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
          \underline{\ell}&:&(\dt: \datatype) \to \tyval{\dt}{\readacc}\\
          \prim{neg}&:&\{\dt : \datatype\} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc} \\
          (+,*,/,-)   &:&\{\dt : \datatype\} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc}\\
          (>=,<=,==)   &:&\{\dt : \datatype\} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\mathsf{bool}}{\readacc}\\
          \prim{select} &:&\{\dt : \datatype\} \to \tyval{\mathsf{bool}}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc}\\          
         
          \medskip\\
          
          \prim{map}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\writeacc} \\
          \prim{mapSeq}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\writeacc} \\
  
          \prim{reduce}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dt : \datatype\} \to (\tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\writeacc}) \to \tyval{\dt}{\writeacc} \to \tyval{\lArray{\n}{\dt}}{\readacc} \to \tyval{\dt}{\readacc}\\
          \prim{reduceSeq}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\dttwo}{\writeacc} \to \tyval{\lArray{\n}{\dtone}}{\readacc} \to \tyval{\dttwo}{\readacc}\\
          \prim{reduceSeqUnroll}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\dttwo}{\writeacc} \to \tyval{\lArray{\n}{\dtone}}{\readacc} \to \tyval{\dttwo}{\readacc}\\
          \prim{scanSeq}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\dttwo}{\writeacc} \to \tyval{\lArray{\n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\readacc}\\
          \prim{iterate}&:&\{\n~\m : \natkind\} \to (\nat{k} : \natkind) \to \{\dt : \datatype\} \to ((\nat{l} : \natkind) \to \tyval{\lArray{\nat{l\n}}{\dt}}{\readacc} \to \tyval{\lArray{\nat{l}}{\dt}}{\readacc}) \to \tyval{\lArray{\nat{(\m \cdot \n^{k})}}{\dt}}{\readacc} \to \tyval{\lArray{\m}{\dt}}{\readacc}\\
          
          \medskip\\
  
          \prim{split}&:&(\n : \natkind) \to \{\m : \natkind\} \to \{\wvar : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{\n\m}{\dt}}{\wvar} \to \tyval{\lArray{\m}{\lArray{\n}{\dt}}}{\wvar} \\
          \prim{join}&:&\{\n~\m : \natkind\} \to \{\wvar : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{\n}{\lArray{\m}{\dt}}}{\wvar} \to \tyval{\lArray{\n\m}{\dt}}{\wvar}\\
          \\[-.75em]
          \prim{slide}&:&\{\n : \natkind\} \to (\nat{sz}~\nat{sp} : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{\nat{(sp \cdot n + sz - sp)}}{\dt}}{\readacc} \to \tyval{\lArray{\n}{\lArray{\nat{sz}}{\dt}}}{\readacc} \\
          \prim{slideSeqRotValues}&:&\{\n : \natkind\} \to (\nat{sz}~\nat{sp} : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{\nat{(sp \cdot n + sz - sp)}}{\dt}}{\readacc} \to \tyval{\lArray{\n}{\lArray{\nat{sz}}{\dt}}}{\readacc} \\
          \prim{slideSeqRotIndices}&:&\{\n : \natkind\} \to (\nat{sz}~\nat{sp} : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{\nat{(sp \cdot n + sz - sp)}}{\dt}}{\readacc} \to \tyval{\lArray{\n}{\lArray{\nat{sz}}{\dt}}}{\readacc} \\
          \prim{slideSeqBuffer}&:&\{\n : \natkind\} \to (\nat{sz}~\nat{sp} : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{\nat{(sp \cdot n + sz - sp)}}{\dt}}{\readacc} \to \tyval{\lArray{\n}{\lArray{\nat{sz}}{\dt}}}{\readacc} \\
          \\[-.75em]
          \prim{transpose}&:&\{\n~\m : \natkind\} \to \{\dt : \datatype\} \to \tyval{\lArray{\n}{\lArray{\m}{\dt}}}{\readacc} \to \tyval{\lArray{\m}{\lArray{\n}{\dt}}}{\readacc}\\
          \\[-.75em]
          % \prim{gather}&:&(n : \natkind) \to (\dt : \datatype) \to (\tyval{\tyidx[n]}{\readacc} \to \tyval{\tyidx[n]}{\readacc}) \to \tyval{n.\dt}{\readacc} \to \tyval{n.\dt}{\readacc}\\
          % \prim{scatter}&:&(n : \natkind) \to (\dt : \datatype) \to (\tyval{\tyidx[n]}{\readacc} \to \tyval{\tyidx[n]}{\readacc}) \to \tyval{n.\dt}{\writeacc} \to \tyval{n.\dt}{\writeacc}\\
          \prim{reorder}&:&\{\n : \natkind\} \to \{\dt : \datatype\} \to
            (\tyval{\tyidx[\n]}{\readacc} \to \tyval{\tyidx[\n]}{\readacc}) \to
            (\tyval{\tyidx[\n]}{\readacc} \to \tyval{\tyidx[\n]}{\readacc}) \to
            \tyval{\lArray{\n}{\dt}}{\readacc} \to \tyval{\lArray{\n}{\dt}}{\readacc}\\
          \\[-.75em]
          \prim{generate}&:&\{\n : \natkind\} \to \{\dt : \datatype\} \to \tyval{\tyidx[\n]}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\lArray{\n}{\dt}}{\readacc}\\
          \\[-.75em]
          \prim{drop}&:&(\n : \natkind) \to \{\m : \natkind\} \to \{\wvar : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{(\n + \m)}{\dt}}{\wvar} \to \tyval{\lArray{m}{\dt}}{\wvar} \\
          \prim{take}&:&(\n : \natkind) \to \{\m : \natkind\} \to \{\wvar : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{(\n + \m)}{\dt}}{\wvar} \to \tyval{\lArray{n}{\dt}}{\wvar}\\
          \\[-.75em]
          \prim{padCst}&:&\{\n : \natkind\} \to (\nat{l}~\nat{q} : \natkind) \to \{\dt : \datatype\} \to \tyval{\dt}{\readacc} \to \tyval{\lArray{\n}{\dt}}{\readacc} \to \tyval{\lArray{(\nat{l} + \n + \nat{q})}{\dt}}{\readacc} \\
          \prim{padClamp}&:&\{\n : \natkind\} \to (\nat{l}~\nat{q} : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{\n}{\dt}}{\readacc} \to \tyval{\lArray{(\nat{l} + \n + \nat{q})}{\dt}}{\readacc} \\
          \\[-.75em]
          \prim{zip}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to \tyval{\lArray{\n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\readacc} \to \tyval{\lArray{\n}{(\lPair{\dtone}{\dttwo})}}{\readacc} \\
          \prim{unzip}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to \tyval{\lArray{\n}{(\lPair{\dtone}{\dttwo})}}{\readacc} \to \tyval{(\lPair{\lArray{\n}{\dtone}}{\lArray{\n}{\dttwo}})}{\readacc}\\
          \\[-.75em]
          \prim{pair}&:&\{\dtone~\dttwo: \datatype\} \to \tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\readacc} \to \tyval{\lPair{\dtone}{\dttwo}}{\readacc}\\
          \prim{fst}&:&\{\dtone~\dttwo : \datatype\} \to \tyval{\lPair{\dtone}{\dttwo}}{\readacc} \to \tyval{\dtone}{\readacc} \\
          \prim{snd}&:&\{\dtone~\dttwo : \datatype\} \to \tyval{\lPair{\dtone}{\dttwo}}{\readacc} \to \tyval{\dttwo}{\readacc} \\
          \\[-.75em]
          \prim{idx} &:&\{\n : \natkind\} \to \{\dt : \datatype\} \to \tyval{\tyidx[\n]}{\readacc}  \to \tyval{\lArray{\n}{\dt}}{\readacc} \to \tyval{\dt}{\readacc} \\
          \\[-.75em]
          \prim{indexAsNat}&:&\{\n: \natkind\} \to \tyval{\tyidx[\n]}{\readacc} \to \tyval{\natkind}{\readacc}\\
          \prim{natAsIndex}&:&(\n : \natkind) \to \tyval{\natkind}{\readacc} \to \tyval{\tyidx[\n]}{\readacc}\\
          \\[-.75em]
          \prim{cast}&:&\{\dtone~\dttwo : \datatype\} \to \tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\readacc}\\

          \medskip\\

          \prim{depJoin}&:&\{\n : \natkind\} \to \{\fn : \ntnkind\} \to \{\dt : \datatype\}
            \to \tyval{\lDepArray{\n}{\lNtDT{\nat{i}}{\lArray{(\fn~\nat{i})}}{\dt}}}{\readacc}
            \to \tyval{\lArray{\Sigma_{\nat{j}=0}^{\n-1}(\fn~\nat{j})}{\dt}}{\readacc}\\

          \prim{depMapSeq}&:&\{\n : \natkind\} \to \{\fdtone~\fdttwo : \ntdkind\}
            \to ((\nat{k} : \natkind) \to \tyval{(\fdtone~\nat{k})}{\readacc} \to \tyval{(\fdttwo~\nat{k})}{\readacc})
            \to \tyval{\lDepArray{\n}{\fdtone{}}}{\readacc}
            \to \tyval{\lDepArray{\n}{\fdttwo{}}}{\readacc}\\

          \prim{partition}&:& \{\n: \natkind\} \to \{\dt : \datatype\} \to (\m: \natkind) \to (\fdt : \ntnkind)
            \to \tyval{\lArray{\n}{\dt}}{\readacc}
            \to \tyval{\lDepArray{\m}{\lNtDT{\nat{i}}{\lArray{(\fdt~\nat{i})}{\dt}}}}{\readacc}\\
      \end{tabular*}
  
    \caption{Data Parallel Programming Primitives}
    \label{fig:primitives}
  \end{figure}

\begin{figure}
  \footnotesize
  \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
    \prim{mapGlobal(}i\prim{)}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\writeacc} \qquad \forall i \in \{0, 1, 2\} \\
    \prim{mapLocal(}i\prim{)}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\writeacc} \qquad \forall i \in \{0, 1, 2\} \\
    \prim{mapWorkGroup(}i\prim{)}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\writeacc} \qquad \forall i \in \{0, 1, 2\} \\

    \prim{toMem}&:&\{\dt : \datatype\} \to (\avar : \addrkind) \to \tyval{\dt}{\writeacc} \to \tyval{\dt}{\readacc} \\
  \end{tabular*}
  \caption{OpenCL Primitives}
  \label{fig:ocl-primitives}
\end{figure}

\begin{figure}
  \footnotesize
  \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
    \prim{mapPar}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\readacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{\n}{\dtone}}{\readacc} \to \tyval{\lArray{\n}{\dttwo}}{\writeacc}\\
    \prim{reducePar}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dt : \datatype\} \to (\tyval{\dt}{\readacc} \to \tyval{\dt}{\readacc} \to \tyval{\dt}{\writeacc}) \to \tyval{\dt}{\writeacc} \to \tyval{\lArray{\n}{\dt}}{\readacc} \to \tyval{\dt}{\readacc}\\
  \end{tabular*}
  \caption{OpenMP Primitives}
  \label{fig:omp-primitives}
\end{figure}