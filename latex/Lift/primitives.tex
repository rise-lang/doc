\begin{figure}
    \footnotesize
    \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
          \underline{\ell}&:&(dt: \datatype) \to \tyval{\dt}{\pureacc}\\
          \prim{neg}&:&\{\dt : \datatype\} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc} \\
          (+,*,/,-)   &:&\{\dt : \datatype\} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc}\\
          (>=,<=,==)   &:&\{\dt : \datatype\} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\mathsf{bool}}{\pureacc}\\
          \prim{select} &:&\{\dt : \datatype\} \to \tyval{\mathsf{bool}}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc}\\          
         
          \medskip\\
          
          \prim{map}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\writeacc} \\
          \prim{mapSeq}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\writeacc} \\
  
          \prim{reduce}&:&\{n : \natkind\} \to \{a : \addrkind\} \to \{\dt : \datatype\} \to (\tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\writeacc}) \to \tyval{\dt}{\writeacc} \to \tyval{\lArray{n}{\dt}}{\pureacc} \to \tyval{\dt}{\pureacc}\\
          \prim{reduceSeq}&:&\{n : \natkind\} \to \{a : \addrkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\dttwo}{\writeacc} \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\dttwo}{\pureacc}\\
          \prim{reduceSeqUnroll}&:&\{n : \natkind\} \to \{a : \addrkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\dttwo}{\writeacc} \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\dttwo}{\pureacc}\\
          \prim{scanSeq}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\dttwo}{\writeacc} \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\pureacc}\\
          \prim{iterate}&:&\{n~m : \natkind\} \to (k : \natkind) \to \{\dt : \datatype\} \to ((l : \natkind) \to \tyval{\lArray{ln}{\dt}}{\pureacc} \to \tyval{\lArray{l}{\dt}}{\pureacc}) \to \tyval{\lArray{(m(n^{k}))}{\dt}}{\pureacc} \to \tyval{\lArray{m}{\dt}}{\pureacc}\\
          
          \medskip\\
  
          \prim{split}&:&(n : \natkind) \to \{m : \natkind\} \to \{w : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{nm}{\dt}}{w} \to \tyval{\lArray{m}{\lArray{n}{\dt}}}{w} \\
          \prim{join}&:&\{n~m : \natkind\} \to \{w : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{n}{\lArray{m}{\dt}}}{w} \to \tyval{\lArray{nm}{\dt}}{w}\\
          \\[-.75em]
          \prim{slide}&:&\{n : \natkind\} \to (sz~sp : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{(sp \times n + sz - sp)}{\dt}}{\pureacc} \to \tyval{\lArray{n}{\lArray{sz}{\dt}}}{\pureacc} \\
          \prim{slideSeqRotValues}&:&\{n : \natkind\} \to (sz~sp : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{(sp \times n + sz - sp)}{\dt}}{\pureacc} \to \tyval{\lArray{n}{\lArray{sz}{\dt}}}{\pureacc} \\
          \prim{slideSeqRotIndices}&:&\{n : \natkind\} \to (sz~sp : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{(sp \times n + sz - sp)}{\dt}}{\pureacc} \to \tyval{\lArray{n}{\lArray{sz}{\dt}}}{\pureacc} \\
          \prim{slideSeqBuffer}&:&\{n : \natkind\} \to (sz~sp : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{(sp \times n + sz - sp)}{\dt}}{\pureacc} \to \tyval{\lArray{n}{\lArray{sz}{\dt}}}{\pureacc} \\
          \\[-.75em]
          \prim{transpose}&:&\{n~m : \natkind\} \to \{\dt : \datatype\} \to \tyval{\lArray{n}{\lArray{m}{\dt}}}{\pureacc} \to \tyval{\lArray{m}{\lArray{n}{\dt}}}{\pureacc}\\
          \\[-.75em]
          % \prim{gather}&:&(n : \natkind) \to (\dt : \datatype) \to (\tyval{\tyidx[n]}{\pureacc} \to \tyval{\tyidx[n]}{\pureacc}) \to \tyval{n.\dt}{\pureacc} \to \tyval{n.\dt}{\pureacc}\\
          % \prim{scatter}&:&(n : \natkind) \to (\dt : \datatype) \to (\tyval{\tyidx[n]}{\pureacc} \to \tyval{\tyidx[n]}{\pureacc}) \to \tyval{n.\dt}{\writeacc} \to \tyval{n.\dt}{\writeacc}\\
          \prim{reorder}&:&\{n : \natkind\} \to \{\dt : \datatype\} \to
            (\tyval{\tyidx[n]}{\pureacc} \to \tyval{\tyidx[n]}{\pureacc}) \to
            (\tyval{\tyidx[n]}{\pureacc} \to \tyval{\tyidx[n]}{\pureacc}) \to
            \tyval{\lArray{n}{\dt}}{\pureacc} \to \tyval{\lArray{n}{\dt}}{\pureacc}\\
          \\[-.75em]
          \prim{generate}&:&\{n : \natkind\} \to \{\dt : \datatype\} \to \tyval{\tyidx[n]}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\lArray{n}{\dt}}{\pureacc}\\
          \\[-.75em]
          \prim{drop}&:&(n : \natkind) \to \{m : \natkind\} \to \{w : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{(n + m)}{\dt}}{w} \to \tyval{\lArray{m}{\dt}}{w} \\
          \prim{take}&:&(n : \natkind) \to \{m : \natkind\} \to \{w : \access\} \to \{\dt : \datatype\} \to \tyval{\lArray{(n + m)}{\dt}}{w} \to \tyval{\lArray{n}{\dt}}{w}\\
          \\[-.75em]
          \prim{padCst}&:&\{n : \natkind\} \to (l~q : \natkind) \to \{\dt : \datatype\} \to \tyval{\dt}{\pureacc} \to \tyval{\lArray{n}{\dt}}{\pureacc} \to \tyval{\lArray{(l + n + q)}{\dt}}{\pureacc} \\
          \prim{padClamp}&:&\{n : \natkind\} \to (l~q : \natkind) \to \{\dt : \datatype\} \to \tyval{\lArray{n}{\dt}}{\pureacc} \to \tyval{\lArray{(l + n + q)}{\dt}}{\pureacc} \\
          \\[-.75em]
          \prim{zip}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\pureacc} \to \tyval{\lArray{n}{(\dtone \times \dttwo)}}{\pureacc} \\
          \prim{unzip}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to \tyval{\lArray{n}{(\dtone \times \dttwo)}}{\pureacc} \to \tyval{(\lArray{n}{\dtone} \times \lArray{n}{\dttwo})}{\pureacc}\\
          \\[-.75em]
          \prim{pair}&:&\{\dtone~\dttwo: \datatype\} \to \tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\pureacc} \to \tyval{\dtone \times \dttwo}{\pureacc}\\
          \prim{fst}&:&\{\dtone~\dttwo : \datatype\} \to \tyval{\dtone \times \dttwo}{\pureacc} \to \tyval{\dtone}{\pureacc} \\
          \prim{snd}&:&\{\dtone~\dttwo : \datatype\} \to \tyval{\dtone \times \dttwo}{\pureacc} \to \tyval{\dttwo}{\pureacc} \\
          \\[-.75em]
          \prim{idx} &:&\{n : \natkind\} \to \{\dt : \datatype\} \to \tyval{\tyidx[n]}{\pureacc}  \to \tyval{\lArray{n}{\dt}}{\pureacc} \to \tyval{\dt}{\pureacc} \\
          \\[-.75em]
          \prim{indexAsNat}&:&\{n: \natkind\} \to \tyval{\tyidx[n]}{\pureacc} \to \tyval{\natkind}{\pureacc}\\
          \prim{natAsIndex}&:&(n : \natkind) \to \tyval{\natkind}{\pureacc} \to \tyval{\tyidx[n]}{\pureacc}\\
          \\[-.75em]
          \prim{cast}&:&\{\dtone~\dttwo : \datatype\} \to \tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\pureacc}\\

          \medskip\\

          \prim{depJoin}&:&\{n : \natkind\} \to \{f : \ntnkind\} \to \{\dt : \datatype\}
            \to \tyval{\lDepArray{n}{\lNtDT{i}{\lArray{(f~i)}}{\dt}}}{\pureacc}
            \to \tyval{\lArray{\Sigma_{j=0}^{n-1}(f~j)}{\dt}}{\pureacc}\\

          \prim{depMapSeq}&:&\{n : \natkind\} \to \{\fdtone~\fdttwo : \ntdkind\}
            \to ((k : \natkind) \to \tyval{(\fdtone~k)}{\pureacc} \to \tyval{(\fdttwo~k)}{\pureacc})
            \to \tyval{\lDepArray{n}{\fdtone{}}}{\pureacc}
            \to \tyval{\lDepArray{n}{\fdttwo{}{}}}{\pureacc}\\

          \prim{partition}&:& \{n: \natkind\} \to \{\dt : \datatype\} \to (m: \natkind) \to (\fdtone : \ntnkind)
            \to \tyval{\lArray{n}{\dt}}{\pureacc}
            \to \tyval{\lDepArray{m}{\lNtDT{i}{\lArray{(\fdtone~i)}{\dt}}}}{\pureacc}\\
      \end{tabular*}
  
    \caption{Data Parallel Programming Primitives}
    \label{fig:primitives}
  \end{figure}

\begin{figure}
  \footnotesize
  \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
    \prim{mapGlobal(}i\prim{)}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\writeacc} \qquad \forall i \in \{0, 1, 2\} \\
    \prim{mapLocal(}i\prim{)}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\writeacc} \qquad \forall i \in \{0, 1, 2\} \\
    \prim{mapWorkGroup(}i\prim{)}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\writeacc} \qquad \forall i \in \{0, 1, 2\} \\

    \prim{toMem}&:&\{\dt : \datatype\} \to (a : \addrkind) \to \tyval{\dt}{\writeacc} \to \tyval{\dt}{\pureacc} \\
  \end{tabular*}
  \caption{OpenCL Primitives}
  \label{fig:ocl-primitives}
\end{figure}

\begin{figure}
  \footnotesize
  \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
    \prim{mapPar}&:&\{n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\tyval{\dtone}{\pureacc} \to \tyval{\dttwo}{\writeacc}) \to \tyval{\lArray{n}{\dtone}}{\pureacc} \to \tyval{\lArray{n}{\dttwo}}{\writeacc}\\
    \prim{reducePar}&:&\{n : \natkind\} \to \{a : \addrkind\} \to \{\dt : \datatype\} \to (\tyval{\dt}{\pureacc} \to \tyval{\dt}{\pureacc} \to \tyval{\dt}{\writeacc}) \to \tyval{\dt}{\writeacc} \to \tyval{\lArray{n}{\dt}}{\pureacc} \to \tyval{\dt}{\pureacc}\\
  \end{tabular*}
  \caption{OpenMP Primitives}
  \label{fig:omp-primitives}
\end{figure}