\begin{figure}
    \footnotesize
    \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
          % FIXME: literal, consistency with implementation
          \underline{\ell}&:&(\dt: \datatype) \to \dt \\
          \prim{neg}&:&\{\dt : \datatype\} \to \dt \to \dt \\
          (+,*,/,-)   &:&\{\dt : \datatype\} \to \dt \to \dt \to \dt \\
          (>=,<=,==)   &:&\{\dt : \datatype\} \to \dt \to \dt \to bool \\
          \prim{select} &:&\{\dt : \datatype\} \to bool \to \dt \to \dt \to \dt\\ 
         
          \medskip\\
          
          \prim{map}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo) \to \lArray{n}{\dtone} \to \lArray{\n}{\dttwo} \\
          \prim{mapSeq}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo) \to \lArray{n}{\dtone} \to \lArray{\n}{\dttwo} \\
  
          \prim{reduce}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dt : \datatype\} \to (\dt \to \dt \to \dt) \to \dt \to \lArray{\n}{\dt} \to \dt\\
          \prim{reduceSeq}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo \to \dttwo) \to \dttwo \to \lArray{\n}{\dtone} \to \dttwo\\
          \prim{reduceSeqUnroll}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo \to \dttwo) \to \dttwo \to \lArray{\n}{\dtone} \to \dttwo\\
          \prim{scanSeq}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo \to \dttwo) \to \dttwo \to \lArray{\n}{\dtone} \to \lArray{\n}{\dttwo}\\
          \prim{iterate}&:&\{\n~\m : \natkind\} \to (\nat{k} : \natkind) \to \{\dt : \datatype\} \to ((\nat{l} : \natkind) \to \lArray{\nat{l\n}}{\dt} \to \lArray{\nat{l}}{\dt}) \to \lArray{\nat{(\m \cdot \n^{k})}}{\dt} \to \lArray{\m}{\dt}\\
          
          \medskip\\
  
          \prim{split}&:&(\n : \natkind) \to \{\m : \natkind\} \to \{\dt : \datatype\} \to \lArray{\n\m}{\dt} \to \lArray{\m}{\lArray{\n}{\dt}} \\
          \prim{join}&:&\{\n~\m : \natkind\} \to \{\dt : \datatype\} \to \lArray{\n}{\lArray{\m}{\dt}} \to \lArray{\n\m}{\dt}\\
          \\[-.75em]
          \prim{slide}&:&\{\n : \natkind\} \to (\nat{sz}~\nat{sp} : \natkind) \to \{\dt : \datatype\} \to \lArray{\nat{(sp \cdot n + sz - sp)}}{\dt} \to \lArray{\n}{\lArray{\nat{sz}}{\dt}} \\
          \prim{slideSeq(}rot\prim{)}&:&\{\n : \natkind\} \to (\nat{sz}~\nat{sp} : \natkind) \to \{\dt : \datatype\} \to \lArray{\nat{(sp \cdot n + sz - sp)}}{\dt} \to \lArray{\n}{\lArray{\nat{sz}}{\dt}} \qquad \forall rot \in \{ \text{values}, \text{indices} \}\\
          \\[-.75em]
          \prim{transpose}&:&\{\n~\m : \natkind\} \to \{\dt : \datatype\} \to \lArray{\n}{\lArray{\m}{\dt}} \to \lArray{\m}{\lArray{\n}{\dt}}\\
          \\[-.75em]
          % \prim{gather}&:&(n : \natkind) \to (\dt : \datatype) \to (\tyidx[n] \to \tyidx[n]) \to n.\dt \to n.\dt\\
          % \prim{scatter}&:&(n : \natkind) \to (\dt : \datatype) \to (\tyidx[n] \to \tyidx[n]) \to n.\dt \to n.\dt\\
          \prim{reorder}&:&\{\n : \natkind\} \to \{\dt : \datatype\} \to
            (\tyidx[\n] \to \tyidx[\n]) \to
            (\tyidx[\n] \to \tyidx[\n]) \to
            \lArray{\n}{\dt} \to \lArray{\n}{\dt}\\
          \\[-.75em]
          \prim{generate}&:&\{\n : \natkind\} \to \{\dt : \datatype\} \to (\tyidx[\n] \to \dt) \to \lArray{\n}{\dt}\\
          \\[-.75em]
          \prim{drop}&:&(\n : \natkind) \to \{\m : \natkind\} \to \{\dt : \datatype\} \to \lArray{(\n + \m)}{\dt} \to \lArray{m}{\dt} \\
          \prim{take}&:&(\n : \natkind) \to \{\m : \natkind\} \to \{\dt : \datatype\} \to \lArray{(\n + \m)}{\dt} \to \lArray{n}{\dt}\\
          \\[-.75em]
          \prim{padCst}&:&\{\n : \natkind\} \to (\nat{l}~\nat{q} : \natkind) \to \{\dt : \datatype\} \to \dt \to \lArray{\n}{\dt} \to \lArray{(\nat{l} + \n + \nat{q})}{\dt} \\
          \prim{padClamp}&:&\{\n : \natkind\} \to (\nat{l}~\nat{q} : \natkind) \to \{\dt : \datatype\} \to \lArray{\n}{\dt} \to \lArray{(\nat{l} + \n + \nat{q})}{\dt} \\
          \\[-.75em]
          \prim{zip}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to \lArray{\n}{\dtone} \to \lArray{\n}{\dttwo} \to \lArray{\n}{(\lPair{\dtone}{\dttwo})} \\
          \prim{unzip}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to \lArray{\n}{(\lPair{\dtone}{\dttwo})} \to (\lPair{\lArray{\n}{\dtone}}{\lArray{\n}{\dttwo}})\\
          \\[-.75em]
          \prim{pair}&:&\{\dtone~\dttwo: \datatype\} \to \dtone \to \dttwo \to \lPair{\dtone}{\dttwo}\\
          \prim{fst}&:&\{\dtone~\dttwo : \datatype\} \to \lPair{\dtone}{\dttwo} \to \dtone \\
          \prim{snd}&:&\{\dtone~\dttwo : \datatype\} \to \lPair{\dtone}{\dttwo} \to \dttwo \\
          \\[-.75em]
          \prim{idx} &:&\{\n : \natkind\} \to \{\dt : \datatype\} \to \tyidx[\n]  \to \lArray{\n}{\dt} \to \dt \\
          \\[-.75em]
          \prim{indexAsNat}&:&\{\n: \natkind\} \to \tyidx[\n] \to \natkind\\
          \prim{natAsIndex}&:&(\n : \natkind) \to \natkind \to \tyidx[\n]\\
          \\[-.75em]
          \prim{cast}&:&\{\dtone~\dttwo : \datatype\} \to \dtone \to \dttwo\\

          \medskip\\

          \prim{depJoin}&:&\{\n : \natkind\} \to \{\fn : \ntnkind\} \to \{\dt : \datatype\}
            \to \lDepArray{\n}{\lNtDT{\nat{i}}{\lArray{(\fn~\nat{i})}}{\dt}}
            \to \lArray{\Sigma_{\nat{j}=0}^{\n-1}(\fn~\nat{j})}{\dt}\\

          \prim{depMapSeq}&:&\{\n : \natkind\} \to \{\fdtone~\fdttwo : \ntdkind\}
            \to ((\nat{k} : \natkind) \to (\fdtone~\nat{k}) \to (\fdttwo~\nat{k}))
            \to \lDepArray{\n}{\fdtone{}}
            \to \lDepArray{\n}{\fdttwo{}}\\

          \prim{partition}&:& \{\n: \natkind\} \to \{\dt : \datatype\} \to (\m: \natkind) \to (\fn : \ntnkind)
            \to \lArray{\n}{\dt}
            \to \lDepArray{\m}{\lNtDT{\nat{i}}{\lArray{(\fn~\nat{i})}{\dt}}}\\
      \end{tabular*}
  
    \caption{Data Parallel Programming Primitives}
    \label{fig:primitives}
  \end{figure}

\begin{figure}
  \footnotesize
  \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
    \prim{map}P\prim{(}i\prim{)}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo) \to \lArray{n}{\dtone} \to \lArray{\n}{\dttwo}
      \qquad \forall P \in \{ \mathsf{global}, \mathsf{local}, \mathsf{workGroup} \} \wedge \forall i \in \{0, 1, 2\}\\

    \prim{toMem}&:&\{\dt : \datatype\} \to (\avar : \addrkind) \to \dt \to \dt \\
  \end{tabular*}
  \caption{OpenCL Primitives}
  \label{fig:ocl-primitives}
\end{figure}

\begin{figure}
  \footnotesize
  \begin{tabular*}{\linewidth}{>{$}l<{$}@{\hspace{0.4em}}>{$}c<{$}>{$}l<{$}}
    \prim{mapPar}&:&\{\n : \natkind\} \to \{\dtone~\dttwo : \datatype\} \to (\dtone \to \dttwo) \to \lArray{\n}{\dtone} \to \lArray{\n}{\dttwo}\\
    \prim{reducePar}&:&\{\n : \natkind\} \to \{\avar : \addrkind\} \to \{\dt : \datatype\} \to (\dt \to \dt \to \dt) \to \dt \to \lArray{\n}{\dt} \to \dt\\
  \end{tabular*}
  \caption{OpenMP Primitives}
  \label{fig:omp-primitives}
\end{figure}